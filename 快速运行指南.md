# AI Travel Planner - 快速运行指南（给验收人员）

## 📦 文件说明

您应该收到以下文件：
- `ai-travel-planner-docker-image.tar` - Docker 镜像文件（67 MB）
- 本指南文档

## ⚡ 5分钟快速开始

### 前置要求

- ✅ 已安装 Docker Desktop（Windows/Mac）或 Docker Engine（Linux）
- ✅ Docker 正在运行

**安装 Docker Desktop**：
- Windows/Mac: https://www.docker.com/products/docker-desktop/
- 安装后启动 Docker Desktop，等待图标变绿

---

### 步骤 1：导入镜像

打开终端（PowerShell 或命令提示符），进入镜像文件所在目录：

```bash
# Windows PowerShell / Mac / Linux
docker load -i ai-travel-planner-docker-image.tar
```

**预计时间**：30秒 - 1分钟

**成功标志**：
```
Loaded image: ai-travel-planner:latest
```

---

### 步骤 2：创建环境变量文件

在**同一目录**创建 `.env` 文件，内容如下：

```env
DEEPSEEK_API_KEY=your_deepseek_api_key
AMAP_WEB_SERVICE_KEY=your_amap_web_service_key
```

**说明**：
- 这两个 API Key 需要您自己申请（见下文）
- 其他所有配置已内置在镜像中
- 如果仅用于测试，可以使用作者提供的测试 Key（见下文）

---

### 步骤 3：启动应用

#### 方法 A：使用 docker run（简单快速）

```bash
docker run -d \
  --name ai-travel-planner \
  -p 3000:3000 \
  -e DEEPSEEK_API_KEY=your_deepseek_api_key \
  -e AMAP_WEB_SERVICE_KEY=your_amap_web_service_key \
  ai-travel-planner:latest
```

**Windows PowerShell 格式**：
```powershell
docker run -d `
  --name ai-travel-planner `
  -p 3000:3000 `
  -e DEEPSEEK_API_KEY=your_deepseek_api_key `
  -e AMAP_WEB_SERVICE_KEY=your_amap_web_service_key `
  ai-travel-planner:latest
```

#### 方法 B：使用 docker-compose（推荐）

创建 `docker-compose.yml` 文件：

```yaml
version: '3.8'

services:
  app:
    image: ai-travel-planner:latest
    container_name: ai-travel-planner
    ports:
      - "3000:3000"
    env_file:
      - .env
    restart: unless-stopped
```

然后启动：

```bash
docker-compose up -d
```

---

### 步骤 4：访问应用

打开浏览器，访问：

```
http://localhost:3000
```

**应该看到**：AI Travel Planner 登录页面

---

## 🔑 API Keys 申请（如需自己的账号）

### 1. DeepSeek API（AI 行程规划）

**申请地址**：https://platform.deepseek.com/

**步骤**：
1. 注册账号
2. 创建 API Key
3. 复制 Key（格式：`sk-xxxxx`）

**免费额度**：新用户有免费 Token

---

### 2. 高德地图 Web服务（地理编码）

**申请地址**：https://console.amap.com/

**步骤**：
1. 注册并创建应用
2. 选择 **Web服务** 类型
3. 获取 Key

**免费额度**：30万次/天

---

## 📋 功能验证清单

请按以下清单验证应用功能：

### 基础功能
- [ ] 用户注册（邮箱 + 密码）
- [ ] 用户登录
- [ ] 查看个人信息

### 核心功能
- [ ] 创建旅行计划（表单输入）
- [ ] AI 自动生成行程（需要 DeepSeek API Key）
- [ ] 查看行程列表
- [ ] 查看行程详情

### 高级功能
- [ ] 语音输入创建行程（需要浏览器麦克风权限）
- [ ] 地图导航查看行程
  - [ ] 景点标记显示
  - [ ] 景点连线和方向箭头
  - [ ] 按天筛选显示
- [ ] 费用管理
  - [ ] 手动添加费用
  - [ ] 语音添加费用
  - [ ] 查看费用统计图表
- [ ] 公共交通导航系统
  - [ ] 地址搜索和自动补全
  - [ ] 实时公交路线规划
  - [ ] 导航历史记录保存和查看
  - [ ] 多种路线方案比较
  - [ ] 详细路段信息显示（步行、公交、地铁）

### 性能指标
- [ ] 首页加载 < 3秒
- [ ] AI 生成行程 < 1分钟
- [ ] 地图加载 < 10秒
- [ ] 无浏览器控制台错误

---

## 🐛 常见问题

### Q1: 容器无法启动

**检查**：
```bash
docker ps -a
docker logs ai-travel-planner
```

**常见原因**：
- 端口 3000 被占用 → 更改为其他端口：`-p 3001:3000`
- 环境变量未配置 → 检查 `.env` 文件或 `-e` 参数

---

### Q2: 页面打不开

**检查**：
```bash
# 确认容器运行
docker ps

# 确认端口映射
docker port ai-travel-planner
```

**应该显示**：`3000/tcp -> 0.0.0.0:3000`

---

### Q3: AI 生成功能不可用

**原因**：未配置 `DEEPSEEK_API_KEY`

**解决**：
1. 申请 DeepSeek API Key
2. 重启容器并提供正确的 Key

---

### Q4: 地图不显示

**原因**：未配置 `AMAP_WEB_SERVICE_KEY`

**解决**：
1. 申请高德 Web服务 API Key（注意不是 JS API）
2. 重启容器并提供正确的 Key

---

### Q5: 语音识别不工作

**原因**：浏览器未授权麦克风权限

**解决**：
1. 浏览器地址栏左侧点击锁图标
2. 允许麦克风权限
3. 刷新页面

---

## 🛠️ 管理命令

### 查看日志
```bash
docker logs ai-travel-planner
docker logs -f ai-travel-planner  # 实时查看
```

### 停止应用
```bash
docker stop ai-travel-planner
```

### 启动应用
```bash
docker start ai-travel-planner
```

### 重启应用
```bash
docker restart ai-travel-planner
```

### 删除容器
```bash
docker stop ai-travel-planner
docker rm ai-travel-planner
```

### 删除镜像
```bash
docker rmi ai-travel-planner:latest
```

---

## 📊 镜像信息

- **镜像名称**：`ai-travel-planner:latest`
- **镜像大小**：294 MB（tar 文件 67 MB）
- **基础镜像**：Node.js 18 Alpine
- **架构**：linux/amd64
- **端口**：3000

### 已内置配置

✅ **Supabase**（数据库）
- URL 和 Anon Key 已配置
- 可直接使用

✅ **科大讯飞**（语音识别）
- App ID、API Key、API Secret 已配置
- 可直接使用

✅ **高德地图**（地图显示）
- JS API Key 已配置
- 可直接使用

✅ **导航系统**（公共交通）
- 地址服务已配置
- 公交路线规划已配置
- 导航历史记录已配置

### 需要运行时提供

🔧 **DeepSeek API**（AI 行程规划）
- 必需，否则 AI 生成功能不可用

🔧 **高德 Web服务 API**（地理编码）
- 必需，否则地图标记不显示

---

## 🎯 测试建议

### 快速测试流程（5分钟）

1. **注册账号**（1分钟）
   - 访问 http://localhost:3000
   - 点击"注册"
   - 填写邮箱和密码

2. **创建行程**（2分钟）
   - 登录后点击"创建新计划"
   - 填写目的地：南京
   - 填写天数：2
   - 填写预算：2000
   - 点击"生成计划"

3. **查看功能**（2分钟）
   - 查看生成的行程详情
   - 切换到"地图导航"标签页
   - 切换到"费用管理"标签页
   - 添加一条费用记录

### 导航功能测试流程（3分钟）

1. **访问导航页面**（30秒）
   - 点击顶部导航栏的"导航"链接
   - 或直接访问 http://localhost:3000/navigation

2. **测试地址搜索**（1分钟）
   - 在起点输入框中输入"南京"
   - 查看自动补全建议
   - 在终点输入框中输入"上海"
   - 查看自动补全建议

3. **规划路线**（1分钟）
   - 点击"规划路线"按钮
   - 查看生成的多种公交路线方案
   - 点击不同方案查看详细路段信息

4. **查看历史记录**（30秒）
   - 在导航历史记录中查看保存的路线
   - 点击历史记录重新加载路线

### 完整测试流程（15分钟）

请参考上面的"功能验证清单"逐项测试。

---

## 📞 技术支持

### 项目信息

- **GitHub 仓库**：https://github.com/WCG2025/AI-Travel-Planner
- **详细文档**：BUILD_AND_RUN.md
- **技术栈**：Next.js 15 + React + TypeScript + Docker

### 查看完整文档

如果您从 GitHub 克隆了项目，可以查看以下文档：

- `BUILD_AND_RUN.md` - 完整运行指南
- `DELIVERY_PACKAGE.md` - 交付包说明
- `FINAL_SUMMARY.md` - 项目总结
- `README.md` - 项目介绍

### 获取帮助

1. 查看容器日志：`docker logs ai-travel-planner`
2. 查看浏览器控制台（F12）
3. 参考项目文档

---

## ✅ 验收完成

如果以上功能都能正常运行，说明应用部署成功！

**主要特色**：
- 🤖 AI 智能规划（DeepSeek）
- 🎤 语音交互（科大讯飞）
- 🗺️ 地图可视化（高德地图）
- 💰 费用管理
- 🔐 用户认证（Supabase）

---

**祝验收顺利！** 🎉🗺️✈️

如有任何问题，请查看容器日志或项目文档。

